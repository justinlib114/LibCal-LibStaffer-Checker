<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auto Scheduler</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f8f8f8; }
    h1 { text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #fff; }
    th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
    .as { background: #e0f7fa; }
    .pt { background: #fff3e0; }
    .ad { background: #f3e5f5; }
  </style>
</head>
<body>
  <h1>Auto Schedule Suggestions</h1>

  <form method="GET" action="/autoschedule">
    <label>
      Start Date:
      <input type="date" name="start" value="<%= startDate %>" min="<%= startDate %>">
    </label>
    <label>
      End Date:
      <input type="date" name="end" value="<%= endDate %>" max="<%= dayjs().add(90, 'day').format('YYYY-MM-DD') %>">
    </label>
    <button type="submit">Generate</button>
  </form>

  <table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Block</th>
      <th>Suggested Staff</th>
    </tr>
  </thead>
  <tbody>
   <% scheduleSuggestions.forEach(s => {
  const names = s.suggestions.map(p => p.name || "").join(" ");
  const group = names.includes("No one") ? "" :
    /Amelia|Antonio|Nicole|Gary|Emily|Justin/.test(names) ? "as" :
    /Angela|Gail|Tonie|Susan|Patricia|Alex/.test(names) ? "pt" :
    /Christa|Christina/.test(names) ? "ad" : "";
%>

      <tr class="<%= group %>">
        <td><%= s.date %></td>
        <td><%= s.block %></td>
<td>
  <% s.suggestions.forEach(p => { %>
    <span style="<%= p.alreadyAssigned ? 'color: red; font-weight: bold;' : '' %>"><%= p.label %></span><br>
  <% }) %>
</td>

      </tr>
    <% }); %>
  </tbody>
</table>

</body>
</html>
